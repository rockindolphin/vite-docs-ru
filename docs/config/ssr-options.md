# Опции SSR

Если не указано иное, опции в этом разделе применяются как к dev, так и к build.

## ssr.external

- **Тип:** `string[] | true`
- **Связано:** [SSR Externals](/guide/ssr#ssr-externals)

Внешние зависимости и их транзитивные зависимости для SSR. По умолчанию все зависимости являются внешними, кроме связанных зависимостей (для HMR). Если вы предпочитаете внешние связанные зависимости, вы можете передать их имя в эту опцию.

Если `true`, все зависимости, включая связанные зависимости, являются внешними.

Обратите внимание, что явно перечисленные зависимости (используя тип `string[]`) всегда имеют приоритет, если они также перечислены в `ssr.noExternal` (используя любой тип).

## ssr.noExternal

- **Тип:** `string | RegExp | (string | RegExp)[] | true`
- **Связано:** [SSR Externals](/guide/ssr#ssr-externals)

Предотвращает внешние зависимости из списка для SSR, которые будут включены в сборку. По умолчанию только связанные зависимости не являются внешними (для HMR). Если вы предпочитаете внешние связанные зависимости, вы можете передать их имя в опцию `ssr.external`.

Если `true`, никакие зависимости не являются внешними. Однако зависимости, явно перечисленные в `ssr.external` (используя тип `string[]`), могут иметь приоритет и все еще быть внешними. Если установлен `ssr.target: 'node'`, встроенные модули Node.js также будут внешними по умолчанию.

Обратите внимание, что если настроены и `ssr.noExternal: true`, и `ssr.external: true`, `ssr.noExternal` имеет приоритет и никакие зависимости не являются внешними.

## ssr.target

- **Тип:** `'node' | 'webworker'`
- **По умолчанию:** `node`

Целевая платформа для сборки SSR сервера.

## ssr.resolve.conditions

- **Тип:** `string[]`
- **По умолчанию:** `['module', 'node', 'development|production']` (`defaultServerConditions`) (`['module', 'browser', 'development|production']` (`defaultClientConditions`) для `ssr.target === 'webworker'`)
- **Связано:** [Resolve Conditions](./shared-options.md#resolve-conditions)

Эти условия используются в пайплайне плагинов и влияют только на невнешние зависимости во время сборки SSR. Используйте `ssr.resolve.externalConditions` для влияния на внешние импорты.

## ssr.resolve.externalConditions

- **Тип:** `string[]`
- **По умолчанию:** `['node']`

Условия, которые используются во время импорта ssr (включая `ssrLoadModule`) внешних прямых зависимостей (внешних зависимостей, импортированных Vite).

:::tip

При использовании этой опции убедитесь, что запускаете Node с флагом [`--conditions`](https://nodejs.org/docs/latest/api/cli.html#-c-condition---conditionscondition) с теми же значениями как в dev, так и в build для получения согласованного поведения.

Например, при установке `['node', 'custom']`, вы должны запустить `NODE_OPTIONS='--conditions custom' vite` в dev и `NODE_OPTIONS="--conditions custom" node ./dist/server.js` после сборки.

:::

### ssr.resolve.mainFields

- **Тип:** `string[]`
- **По умолчанию:** `['module', 'jsnext:main', 'jsnext']`

Список полей в `package.json`, которые нужно проверять при разрешении точки входа пакета. Обратите внимание, что это имеет более низкий приоритет, чем условные экспорты, разрешенные из поля `exports`: если точка входа успешно разрешена из `exports`, поле main будет проигнорировано. Эта настройка влияет только на невнешние зависимости.
