# Использование плагинов

Vite можно расширять с помощью плагинов, которые основаны на хорошо спроектированном интерфейсе плагинов Rollup с несколькими дополнительными опциями, специфичными для Vite. Это означает, что пользователи Vite могут полагаться на зрелую экосистему плагинов Rollup, а также при необходимости расширять функциональность dev-сервера и SSR.

## Добавление плагина

Чтобы использовать плагин, его нужно добавить в `devDependencies` проекта и включить в массив `plugins` в конфигурационном файле `vite.config.js`. Например, для поддержки устаревших браузеров можно использовать официальный [@vitejs/plugin-legacy](https://github.com/vitejs/vite/tree/main/packages/plugin-legacy):

```
$ npm add -D @vitejs/plugin-legacy
```

```js twoslash [vite.config.js]
import legacy from '@vitejs/plugin-legacy'
import { defineConfig } from 'vite'

export default defineConfig({
  plugins: [
    legacy({
      targets: ['defaults', 'not IE 11'],
    }),
  ],
})
```

`plugins` также принимает пресеты, включающие несколько плагинов как один элемент. Это полезно для сложных функций (таких как интеграция с фреймворками), которые реализованы с использованием нескольких плагинов. Массив будет автоматически развернут внутри.

Ложные значения плагинов будут игнорироваться, что можно использовать для легкой активации или деактивации плагинов.

## Поиск плагинов

:::tip ПРИМЕЧАНИЕ
Vite стремится предоставить поддержку из коробки для общих паттернов веб-разработки. Прежде чем искать плагин Vite или совместимый плагин Rollup, ознакомьтесь с [Руководством по функциям](../guide/features.md). Многие случаи, когда в проекте Rollup потребовался бы плагин, уже покрыты в Vite.
:::

Ознакомьтесь с разделом [Плагины](../plugins/) для получения информации об официальных плагинах. Плагины сообщества перечислены в [awesome-vite](https://github.com/vitejs/awesome-vite#plugins).

Вы также можете найти плагины, которые следуют [рекомендуемым соглашениям](./api-plugin.md#conventions), используя [поиск npm для vite-plugin](https://www.npmjs.com/search?q=vite-plugin&ranking=popularity) для плагинов Vite или [поиск npm для rollup-plugin](https://www.npmjs.com/search?q=rollup-plugin&ranking=popularity) для плагинов Rollup.

## Принудительный порядок плагинов

Для совместимости с некоторыми плагинами Rollup может потребоваться принудительно задать порядок плагина или применять его только во время сборки. Это должно быть деталью реализации для плагинов Vite. Вы можете принудительно задать позицию плагина с помощью модификатора `enforce`:

- `pre`: вызывать плагин до основных плагинов Vite
- по умолчанию: вызывать плагин после основных плагинов Vite
- `post`: вызывать плагин после плагинов сборки Vite

```js twoslash [vite.config.js]
import image from '@rollup/plugin-image'
import { defineConfig } from 'vite'

export default defineConfig({
  plugins: [
    {
      ...image(),
      enforce: 'pre',
    },
  ],
})
```

Ознакомьтесь с [Руководством по API плагинов](./api-plugin.md#plugin-ordering) для получения подробной информации.

## Условное применение

По умолчанию плагины вызываются как для serve, так и для build. В случаях, когда плагин нужно условно применять только во время serve или build, используйте свойство `apply`, чтобы вызывать их только во время `'build'` или `'serve'`:

```js twoslash [vite.config.js]
import typescript2 from 'rollup-plugin-typescript2'
import { defineConfig } from 'vite'

export default defineConfig({
  plugins: [
    {
      ...typescript2(),
      apply: 'build',
    },
  ],
})
```

## Создание плагинов

Ознакомьтесь с [Руководством по API плагинов](./api-plugin.md) для получения документации о создании плагинов.
